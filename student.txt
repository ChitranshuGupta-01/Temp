// src/main/java/com/example/location/LocationController.java
package com.example.location;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/locations")
public class LocationController {

    @Autowired
    private LocationRepository repository;

    // 1) Get info by pincode
    @GetMapping("/pincode/{pincode}")
    public ResponseEntity<Location> getByPincode(@PathVariable Integer pincode) {
        return repository.findById(pincode)
                .map(ResponseEntity::ok)     // If found return 200 + object
                .orElse(ResponseEntity.notFound().build()); // else 404
    }

    // 2) Get all pincodes for a city
    @GetMapping("/city/{city}/pincodes")
    public ResponseEntity<List<Integer>> getPincodesByCity(@PathVariable String city) {
        List<Location> locations = repository.findByCity(city);
        if (locations.isEmpty()) {
            return ResponseEntity.notFound().build();
        }
        List<Integer> pincodes = locations.stream()
                .map(Location::getPincode)
                .toList();
        return ResponseEntity.ok(pincodes);
    }
}
