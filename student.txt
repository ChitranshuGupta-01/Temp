-- Step 1: Create trigger function
CREATE OR REPLACE FUNCTION insert_into_onboarding_applications()
RETURNS TRIGGER AS $$
DECLARE
    handlers text[] := ARRAY['user1', 'user2', 'user3'];
    random_handler text;
BEGIN
    -- Pick a random handler
    random_handler := handlers[ceil(random() * array_length(handlers, 1))];

    -- Insert applicant into onboarding_applications
    INSERT INTO onboarding_applications (id, applicant, handler, status)
    VALUES (NEW.id::varchar, NEW.full_name, random_handler, 'Application Processing'); 

    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Step 2: Create the trigger
CREATE TRIGGER after_applications_insert
AFTER INSERT ON applications
FOR EACH ROW
EXECUTE FUNCTION insert_into_onboarding_applications();
